<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet id="Create HOTEL_5_STARS_VIEW" author="Liquibase" runAlways="true" runOnChange="true" failOnError="true">
        <createView viewName="HOTEL_5_STARS_VIEW" fullDefinition="false" replaceIfExists="true">
            SELECT H.HOTEL_ID, H.NAME, H.STARS, H.WEBSITE, H.LONGITUDE, H.LATITUDE FROM HOTELS H WHERE H.STARS = 5
        </createView>
    </changeSet>

    <changeSet id="Create HOTEL_FEATURES_VIEW" author="Liquibase" dbms="oracle" runAlways="true" runOnChange="true" failOnError="true">
        <createView viewName="HOTEL_FEATURES_VIEW" fullDefinition="false" replaceIfExists="true">
            SELECT * FROM
            (SELECT H.NAME AS HOTEL_NAME, F.NAME FROM FEATURES F
            INNER JOIN HOTELS_FEATURES H_F ON F.FEATURE_ID = H_F.FEATURE_ID
            INNER JOIN HOTELS H ON H_F.HOTEL_ID = H.HOTEL_ID)
            PIVOT (COUNT(NAME) FOR NAME IN ('air-conditioner', 'cable TV', 'car rental', 'mini-bar', 'parking',
            'restaurant', 'room service', 'spa', 'swimming pool', 'wi-fi'))
        </createView>
    </changeSet>

    <changeSet id="Create TOUR_FUTURE_VIEW" author="Liquibase" dbms="oracle" runAlways="true" runOnChange="true" failOnError="true">
        <createView viewName="TOUR_FUTURE_VIEW" fullDefinition="false" replaceIfExists="true">
            SELECT T.TOUR_ID, T.PHOTO_PATH, T.START_DATE, T.END_DATE, T.DESCRIPTION, T.COST, T.TOUR_TYPE, T.COUNTRY_ID, T.HOTEL_ID
            FROM TOURS T WHERE T.START_DATE &gt;= SYSTIMESTAMP
        </createView>
    </changeSet>
    <changeSet id="Create VIEWS for TOURS" author="Liquibase" dbms="postgresql" runAlways="true" runOnChange="true" failOnError="true">
        <createView viewName="TOUR_FUTURE_VIEW" fullDefinition="false" replaceIfExists="true">
            SELECT T.TOUR_ID, T.PHOTO_PATH, T.START_DATE, T.END_DATE, T.DESCRIPTION, T.COST, T.TOUR_TYPE, T.COUNTRY_ID, T.HOTEL_ID
            FROM TOURS T WHERE T.START_DATE &gt;= NOW()
        </createView>
    </changeSet>

    <changeSet id="Create REVIEW_FUTURE_VIEW" author="Liquibase" dbms="oracle" runAlways="true" runOnChange="true" failOnError="true">
        <createView viewName="REVIEW_FUTURE_VIEW" fullDefinition="false" replaceIfExists="true">
            SELECT R.REVIEW_ID, R.REVIEW_DATE, R.REVIEW_TEXT, R.USER_ID, R.TOUR_ID FROM REVIEWS R
            WHERE R.REVIEW_DATE &gt;= SYSTIMESTAMP
        </createView>
    </changeSet>
    <changeSet id="Create REVIEW_FUTURE_VIEW" author="Liquibase" dbms="postgresql" runAlways="true" runOnChange="true" failOnError="true">
        <createView viewName="REVIEW_FUTURE_VIEW" fullDefinition="false" replaceIfExists="true">
            SELECT R.REVIEW_ID, R.REVIEW_DATE, R.REVIEW_TEXT, R.USER_ID, R.TOUR_ID FROM REVIEWS R
            WHERE R.REVIEW_DATE &gt;= NOW()
        </createView>
    </changeSet>

</databaseChangeLog>